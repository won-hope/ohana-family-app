@baseUrl = http://localhost:8080
@subjectId = e468924d-7952-4d83-9586-6f07102125da

### 실행 순서
# 1) Dev login 실행 -> accessToken 저장
# 2) (최초 1회) Create group 실행
# 3) Subject 생성 -> Subject 목록 조회로 subjectId 확인
# 4) @subjectId에 붙여넣기
# 5) 수유 기록 등록 -> 멱등성 테스트 -> 수유 기록 조회

### Google login (replace idToken)
POST {{baseUrl}}/auth/google
Content-Type: application/json

{
  "idToken": "REPLACE_WITH_GOOGLE_ID_TOKEN"
}

### Dev login (requires spring profile: dev)
POST {{baseUrl}}/auth/dev

> {%
  client.global.set("accessToken", response.body.accessToken);
%}

### Create group (uses dev token)
POST {{baseUrl}}/groups
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "name": "My First Group"
}

### 내 그룹 목록 조회 (그룹 있는지 확인)
GET {{baseUrl}}/groups
Authorization: Bearer {{accessToken}}

### Subject 생성 (도현이)
POST {{baseUrl}}/subjects
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "type": "BABY",
  "name": "도현",
  "birthDate": "2025-11-06",
  "notes": "귀여운 아들"
}

### Subject 생성 (코코)
POST {{baseUrl}}/subjects
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "type": "PET",
  "name": "hope",
  "notes": "닥스훈트, 심장사상충 매월 25일"
}

### Subject 목록 조회
GET {{baseUrl}}/subjects
Authorization: Bearer {{accessToken}}

### [1] 수유 기록 등록 (도현이가 160ml 먹음)
POST {{baseUrl}}/feedings
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "subjectId": "{{subjectId}}",
  "idempotencyKey": "550e8400-e29b-41d4-a716-446655440000",
  "fedAt": "2026-02-06T12:30:00+09:00",
  "amountMl": 160,
  "method": "BOTTLE",
  "note": "꿀꺽꿀꺽 잘 먹음"
}

### [1-2] 수유 기록 등록 (멱등성 테스트)
# ⚠️ UUID를 고정해놓고 여러 번 실행해봐!
POST {{baseUrl}}/feedings
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "subjectId": "{{subjectId}}",
  "idempotencyKey": "550e8400-e29b-41d4-a716-446655440000",
  "fedAt": "2026-02-06T13:00:00+09:00",
  "amountMl": 180,
  "method": "BOTTLE",
  "note": "멱등성 테스트 중"
}

### [2] 수유 기록 조회 (잘 들어갔나 확인)
GET {{baseUrl}}/feedings/subject/{{subjectId}}
Authorization: Bearer {{accessToken}}

### [3] 케어 이벤트 - 대변(응가) 기록
POST {{baseUrl}}/care-events
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "subjectId": "{{subjectId}}",
  "type": "DIAPER_POO",
  "occurredAt": "2026-02-06T14:00:00+09:00",
  "idempotencyKey": "0f7f07d2-7f4b-4a76-9e52-82c0a1b6a1a1",
  "payload": {
    "color": "GOLD",
    "amount": "MUCH",
    "memo": "황금변! 상태 좋음"
  }
}

### [4] 케어 이벤트 - 목욕 기록
POST {{baseUrl}}/care-events
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "subjectId": "{{subjectId}}",
  "type": "BATH",
  "occurredAt": "2026-02-06T19:30:00+09:00",
  "idempotencyKey": "2b64a7a1-19df-4d36-9f2b-1e7fd28f0b7d",
  "payload": { "memo": "오늘은 아빠랑 목욕" }
}

### [5] 케어 이벤트 - 오늘 타임라인 조회
GET {{baseUrl}}/care-events?subjectId={{subjectId}}&date=2026-02-06
Authorization: Bearer {{accessToken}}

### ✅ 케어 이벤트 테스트 순서
# 1) Dev login 실행 -> accessToken 저장
# 2) Subject 목록 조회 -> subjectId 확인 후 @subjectId 업데이트
# 3) 아래 3개 요청 실행 (DIAPER_POO -> BATH -> 타임라인)

### [6] 대시보드 - 오늘 타임라인 조회 (수유 + 돌봄 통합)
GET {{baseUrl}}/subjects/{{subjectId}}/timeline?date=2026-02-06
Authorization: Bearer {{accessToken}}

### [7] 대시보드 - 오늘 요약 조회
GET {{baseUrl}}/subjects/{{subjectId}}/summary?date=2026-02-06
Authorization: Bearer {{accessToken}}
